<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>國字辨識</title>
  </head>
  <body>
    <div id="quiz"></div>

    <p>請輸入題目，至少 5 個字，以空格分隔</p>
    <textarea id="text" style="width:50%;height:100px;font-size:20px"></textarea>
    <br />
    <input
      type="range"
      id="font-size"
      min="8"
      max="100"
      value="24"
      oninput="updateFontSize()"
    />
    字體大小：<span id="font-size-display">24</span>px
    <br />
    <button id="start" disabled onclick="startQuiz()">開始測驗</button>

    <style>
      button {
        font-size: 16px;
        margin: 10px;
      }
    </style>
    <script>
      function updateFontSize() {
        const fontSize = document.getElementById("font-size").value;
        document.getElementById("font-size-display").innerHTML = fontSize;
        document.getElementById("quiz").style.fontSize = fontSize + "px";
        const buttons = document.querySelectorAll("#quiz button");
        for (const button of buttons) {
          button.style.fontSize = fontSize + "px";
        }
      }

      text.addEventListener("input", function () {
        if (this.value.length >= 9) {
          start.disabled = false;
        } else {
          start.disabled = true;
        }
      });

      function startQuiz() {
        const text = document.getElementById("text").value;
        const words = text.split(" ");
        const index = Math.floor(Math.random() * words.length);
        const answer = words[index];
        const options = [answer];
        while (options.length < 5) {
          const option = words[Math.floor(Math.random() * words.length)];
          if (!options.includes(option)) {
            options.push(option);
          }
        }
        options.sort(() => Math.random() - 0.5);
        const quiz = document.getElementById("quiz");
        quiz.innerHTML = "";
        const question = document.createElement("div");
        question.innerHTML = answer;
        quiz.appendChild(question);
        for (const option of options) {
          const button = document.createElement("button");
          button.innerHTML = option;
          button.onclick = function () {
            if (this.innerHTML === answer) {
              speak("答對了");
              startQuiz();
            } else {
              speak("答錯了");
            }
          };
          quiz.appendChild(button);
        }
        updateFontSize();
      }

      function speak(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        window.speechSynthesis.speak(utterance);
      }
    </script>
  </body>
</html>
